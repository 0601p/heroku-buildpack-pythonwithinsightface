#!/usr/bin/env bash
# Build Path: /app/.heroku/python/

OUT_PREFIX=$1

echo "Building autoconf..."


SOURCE_TARBALL='http://ftp.gnu.org/gnu/autoconf/autoconf-2.68.tar.gz'
curl -L $SOURCE_TARBALL | tar xz

cd autoconf-2.68
./configure --prefix=$OUT_PREFIX
make
make install
cd ..

# Use new Python path, containing autoconf.
export PATH="/app/.heroku/python/bin/:$PATH"
hash -r

echo "Building libffi..."

SOURCE_TARBALL='https://github.com/atgreen/libffi/archive/master.tar.gz'

curl -L $SOURCE_TARBALL | tar xz
mv libffi-master libffi

cd libffi
./autogen.sh
./configure --prefix=$OUT_PREFIX
make
make install

# Cleanup
cd ..
